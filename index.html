<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–∫–µ—Ä –±–∞–ª–∞–Ω—Å–∞ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary-light: #fffdfa;
            --primary-dark: #0a291e;
            --accent: #553922;
            --shadow: 0 8px 32px rgba(10, 41, 30, 0.2);
            --shadow-hover: 0 12px 40px rgba(10, 41, 30, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-dark);
            color: var(--primary-dark);
            min-height: 100vh;
            line-height: 1.4;
            overflow-x: hidden;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 100%;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: var(--primary-light);
            border-bottom: 8px solid var(--accent);
            padding: 16px 15px;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 10;
            border-radius: 0 0 24px 24px;
        }

        .header-content {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .current-month {
            text-align: center;
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .season-icon {
            font-size: 24px;
        }

        .month-name {
            order: 1;
        }

        .tabs {
            display: flex;
            background: var(--primary-light);
            padding: 6px;
            border-radius: 18px;
            border: 2px solid var(--accent);
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.1);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab-button {
            flex: 1;
            padding: 10px 14px;
            border: none;
            background: var(--primary-light);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--primary-dark);
            font-size: 14px;
            border: 2px solid transparent;
            min-width: 0;
            white-space: nowrap;
        }

        .tab-button:hover {
            background: rgba(85, 57, 34, 0.05);
            border-color: var(--accent);
        }

        .tab-button.active {
            background: var(--accent);
            color: var(--primary-light);
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.2);
            border-color: var(--accent);
        }

        .tab-button:active {
            transform: scale(0.95);
        }

        /* Info Button */
        .info-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--accent);
            color: var(--primary-light);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            z-index: 100;
            box-shadow: var(--shadow-hover);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .info-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(85, 57, 34, 0.4);
        }

        .info-button:active {
            transform: scale(0.95);
        }

        /* Body */
        .body {
            flex: 1;
            padding: 20px 15px;
            max-width: 100%;
            margin: 0 auto;
            width: 100%;
            overflow-x: hidden;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            max-width: 100%;
        }

        @media (min-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr 1fr;
            }
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            max-width: 100%;
            overflow-x: hidden;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards and Forms */
        .card {
            background: var(--primary-light);
            border-radius: 18px;
            padding: 20px;
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            max-width: 100%;
            overflow: hidden;
        }

        .card:hover {
            box-shadow: var(--shadow-hover);
        }

        .date-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            max-width: 100%;
        }

        .date-selector button {
            background: var(--primary-light);
            color: var(--primary-dark);
            border: 2px solid var(--accent);
            width: 44px;
            height: 44px;
            border-radius: 22px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.1);
            flex-shrink: 0;
        }

        .date-selector button:hover:not(:disabled) {
            background: var(--accent);
            color: var(--primary-light);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(85, 57, 34, 0.2);
        }

        .date-selector button:disabled {
            background: rgba(255, 253, 250, 0.5);
            color: rgba(10, 41, 30, 0.4);
            border-color: rgba(85, 57, 34, 0.3);
            cursor: not-allowed;
        }

        .date-selector button:active:not(:disabled) {
            transform: scale(0.95);
        }

        #currentDate {
            font-weight: 600;
            font-size: 16px;
            color: var(--primary-dark);
            text-align: center;
            flex: 1;
            margin: 0 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .categories-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 16px;
            max-width: 100%;
        }

        @media (min-width: 768px) {
            .categories-list {
                grid-template-columns: 1fr 1fr;
            }
        }

        .category-item {
            background: var(--primary-light);
            padding: 16px;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.1);
            border: 2px solid transparent;
            max-width: 100%;
            overflow: hidden;
        }

        .category-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(85, 57, 34, 0.15);
            border-color: var(--accent);
        }

        .category-item:active {
            transform: translateY(-2px);
        }

        .category-item.completed {
            background: rgba(85, 57, 34, 0.05);
            border-color: var(--accent);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            max-width: 100%;
        }

        .category-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--primary-dark);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
            margin-right: 10px;
        }

        .category-checkbox {
            width: 22px;
            height: 22px;
            border: 2px solid var(--primary-dark);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .category-item.completed .category-checkbox {
            background: var(--accent);
            border-color: var(--accent);
        }

        .category-item.completed .category-checkbox::after {
            content: '‚úì';
            color: var(--primary-light);
            font-weight: bold;
            font-size: 13px;
        }

        .category-description {
            font-size: 13px;
            color: rgba(10, 41, 30, 0.7);
            line-height: 1.4;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .progress-section {
            text-align: center;
            margin-bottom: 16px;
            max-width: 100%;
        }

        .progress-text {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 12px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: rgba(10, 41, 30, 0.1);
            border-radius: 6px;
            overflow: hidden;
            margin: 12px 0;
            border: 1px solid var(--accent);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--primary-dark));
            border-radius: 6px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .export-buttons {
                flex-direction: column;
            }
        }

        .export-button {
            flex: 1;
            padding: 14px 16px;
            background: var(--primary-light);
            color: var(--primary-dark);
            border: 2px solid var(--accent);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.1);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .export-button:hover {
            background: var(--accent);
            color: var(--primary-light);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(85, 57, 34, 0.2);
        }

        .export-button:active {
            transform: translateY(-2px);
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            max-width: 100%;
        }

        @media (min-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .chart-container {
            background: var(--primary-light);
            padding: 16px;
            border-radius: 18px;
            box-shadow: var(--shadow);
            max-width: 100%;
            overflow: hidden;
        }

        .chart-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
            color: var(--primary-dark);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .category-percentages {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 12px;
            max-width: 100%;
        }

        .category-percentage {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px;
            background: rgba(255, 253, 250, 0.8);
            border-radius: 10px;
            font-size: 13px;
            border: 1px solid var(--accent);
            overflow: hidden;
        }

        .category-percentage-name {
            font-weight: 500;
            color: var(--primary-dark);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-right: 10px;
        }

        .category-percentage-value {
            font-weight: 600;
            color: var(--accent);
            flex-shrink: 0;
        }

        .recommendations-list {
            background: var(--primary-light);
            border-radius: 18px;
            padding: 20px;
            box-shadow: var(--shadow);
            max-width: 100%;
            overflow: hidden;
        }

        .recommendation-item {
            padding: 16px;
            margin-bottom: 12px;
            background: var(--primary-light);
            border-left: 4px solid var(--accent);
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(85, 57, 34, 0.1);
            max-width: 100%;
            overflow: hidden;
        }

        .recommendation-item h4 {
            color: var(--primary-dark);
            margin-bottom: 6px;
            font-size: 15px;
            font-weight: 600;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .recommendation-item p {
            color: rgba(10, 41, 30, 0.8);
            font-size: 13px;
            line-height: 1.4;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .inspiration-quote {
            background: rgba(85, 57, 34, 0.1);
            padding: 16px;
            margin: 16px 0;
            border-radius: 14px;
            border-left: 4px solid var(--accent);
            font-style: italic;
            text-align: center;
            font-size: 14px;
            color: var(--primary-dark);
            max-width: 100%;
            overflow: hidden;
        }

        .info-content {
            background: var(--primary-light);
            border-radius: 18px;
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            max-width: 100%;
            overflow: hidden;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 16px;
        }

        .app-logo {
            width: 80px;
            height: 80px;
            border-radius: 18px;
            object-fit: contain;
            border: 2px solid var(--accent);
            box-shadow: 0 4px 16px rgba(85, 57, 34, 0.2);
        }

        .logo-placeholder {
            width: 80px;
            height: 80px;
            margin: 0 auto 16px;
            background: rgba(85, 57, 34, 0.1);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            color: var(--accent);
            border: 2px dashed var(--accent);
        }

        .info-section {
            margin-bottom: 20px;
            text-align: left;
            max-width: 100%;
            overflow: hidden;
        }

        .info-section h3 {
            color: var(--accent);
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
        }

        .info-section p {
            color: var(--primary-dark);
            line-height: 1.5;
            font-size: 14px;
            margin-bottom: 10px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 5;
            -webkit-box-orient: vertical;
        }

        /* Footer */
        .footer {
            background: var(--primary-light);
            border-top: 8px solid var(--accent);
            padding: 16px;
            text-align: center;
            box-shadow: 0 -4px 20px rgba(10, 41, 30, 0.1);
            border-radius: 24px 24px 0 0;
            max-width: 100%;
        }

        .footer-content {
            max-width: 100%;
            margin: 0 auto;
        }

        .made-with-love {
            font-style: italic;
            color: var(--accent);
            margin-bottom: 6px;
            font-size: 14px;
        }

        .telegram-link {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        /* Animations and Utilities */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        .notification {
            position: fixed;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-light);
            color: var(--primary-dark);
            padding: 14px 20px;
            border-radius: 14px;
            box-shadow: var(--shadow-hover);
            transition: transform 0.3s ease;
            z-index: 1000;
            font-size: 14px;
            font-weight: 500;
            max-width: 90%;
            text-align: center;
            border: 2px solid var(--accent);
        }

        .notification.show {
            transform: translateX(-50%) translateY(100px);
        }

        .export-container {
            background: var(--primary-light);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: var(--shadow-hover);
            max-width: 90%;
            margin: 0 auto;
            position: fixed;
            left: -9999px;
            top: -9999px;
        }

        .export-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 20px;
        }

        .export-watermark {
            margin-top: 20px;
            color: var(--accent);
            font-size: 13px;
            font-style: italic;
            opacity: 0.8;
        }

        .export-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 12px;
            object-fit: contain;
            border-radius: 14px;
            border: 2px solid var(--accent);
        }

        .progress-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 41, 30, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            flex-direction: column;
            gap: 16px;
            padding: 20px;
        }

        .progress-overlay.active {
            display: flex;
        }

        .progress-info {
            font-size: 16px;
            color: var(--primary-light);
            font-weight: 600;
            text-align: center;
            max-width: 90%;
        }

        .progress-bar-overlay {
            width: 80%;
            max-width: 250px;
            height: 6px;
            background: rgba(255, 253, 250, 0.2);
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid var(--accent);
        }

        .progress-fill-overlay {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--primary-light));
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        @media (prefers-color-scheme: dark) {
            body {
                background: var(--primary-dark);
            }
        }

        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 360px) {
            .header {
                padding: 12px 10px;
            }
            
            .body {
                padding: 15px 10px;
            }
            
            .card {
                padding: 16px;
            }
            
            .category-item {
                padding: 12px;
            }
            
            .tab-button {
                padding: 8px 10px;
                font-size: 13px;
            }
            
            .info-button {
                width: 45px;
                height: 45px;
                bottom: 15px;
                right: 15px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="current-month">
                    <span class="month-name" id="monthName"></span>
                    <span class="season-icon" id="seasonIcon">üå±</span>
                </div>
                
                <div class="tabs">
                    <button class="tab-button active" data-tab="tracker">–¢—Ä–µ–∫–µ—Ä</button>
                    <button class="tab-button" data-tab="analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
                    <button class="tab-button" data-tab="recommendations">–°–æ–≤–µ—Ç—ã</button>
                </div>
            </div>
        </header>

        <!-- Body -->
        <main class="body">
            <div class="main-content">
                <div id="tracker" class="tab-content active">
                    <div class="card">
                        <div class="date-selector">
                            <button id="prevDay">‚Üê</button>
                            <span id="currentDate">–°–µ–≥–æ–¥–Ω—è</span>
                            <button id="nextDay">‚Üí</button>
                        </div>
                        
                        <div class="categories-list" id="categoriesList">
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>

                <div id="analytics" class="tab-content">
                    <div class="card">
                        <div class="progress-section">
                            <div class="progress-text" id="monthlyProgressText">–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –º–µ—Å—è—Ü: 0%</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="monthlyProgressFill"></div>
                            </div>
                        </div>

                        <div class="export-buttons">
                            <button class="export-button" id="shareStats">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram</button>
                        </div>

                        <div class="charts-container">
                            <div class="chart-container">
                                <div class="chart-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Å—Ñ–µ—Ä–∞–º</div>
                                <canvas id="progressChart"></canvas>
                                <div class="category-percentages" id="categoryPercentages">
                                    <!-- –ü—Ä–æ—Ü–µ–Ω—Ç—ã –ø–æ —Å—Ñ–µ—Ä–∞–º –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                                </div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                                <canvas id="distributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="recommendations" class="tab-content">
                    <div class="card">
                        <div class="recommendations-list" id="recommendationsList">
                            <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ "–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏" —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "!" -->
                <div id="info" class="tab-content">
                    <div class="card">
                        <div class="info-content">
                            <div class="logo-container">
                                <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="app-logo" onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\'logo-placeholder\'>–õ–æ–≥–æ—Ç–∏–ø</div>';">
                            </div>
                            
                            <div class="info-section">
                                <h3>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è</h3>
                                <p>1. –í —Ä–∞–∑–¥–µ–ª–µ "–¢—Ä–µ–∫–µ—Ä" –æ—Ç–º–µ—á–∞–π—Ç–µ —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã –±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã —Å–µ–≥–æ–¥–Ω—è</p>
                                <p>2. –î–ª—è –±–∞–ª–∞–Ω—Å–∞ —Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –æ—Ç–º–µ—á–∞—Ç—å 3+ —Å—Ñ–µ—Ä—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ</p>
                                <p>3. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å—Ñ–µ—Ä</p>
                                <p>4. –í "–ê–Ω–∞–ª–∏—Ç–∏–∫–µ" –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –º–µ—Å—è—Ü</p>
                                <p>5. –ü–æ–ª—É—á–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã</p>
                            </div>

                            <div class="info-section">
                                <h3>–°—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏</h3>
                                <p>‚Ä¢ <strong>–¢–µ–ª–æ</strong> - —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å–ø–æ—Ä—Ç, –ø–∏—Ç–∞–Ω–∏–µ</p>
                                <p>‚Ä¢ <strong>–ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ</strong> - –º–µ–¥–∏—Ç–∞—Ü–∏—è, –æ—Ç–¥—ã—Ö, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–æ–º</p>
                                <p>‚Ä¢ <strong>–°–º—ã—Å–ª—ã</strong> - —Ü–µ–ª–∏, –º–∏—Å—Å–∏—è, —Ü–µ–Ω–Ω–æ—Å—Ç–∏</p>
                                <p>‚Ä¢ <strong>–û—Ç–Ω–æ—à–µ–Ω–∏—è</strong> - –æ–±—â–µ–Ω–∏–µ —Å –±–ª–∏–∑–∫–∏–º–∏ –∏ –¥—Ä—É–∑—å—è–º–∏</p>
                                <p>‚Ä¢ <strong>–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç</strong> - –æ–±—É—á–µ–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, —Ö–æ–±–±–∏</p>
                                <p>‚Ä¢ <strong>–î–µ–ª–æ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã</strong> - —Ä–∞–±–æ—Ç–∞, –ø—Ä–æ–µ–∫—Ç—ã, —Ñ–∏–Ω–∞–Ω—Å—ã</p>
                                <p>‚Ä¢ <strong>–ü—Ä–∏—Ä–æ–¥–∞</strong> - –ø—Ä–æ–≥—É–ª–∫–∏, –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø—Ä–∏—Ä–æ–¥–æ–π</p>
                                <p>‚Ä¢ <strong>–ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ</strong> - —Å–æ–Ω, –≥–∏–≥–∏–µ–Ω–∞, —Ä–µ–∂–∏–º</p>
                            </div>

                            <div class="info-section">
                                <h3>–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                                <p>‚Ä¢ –¢—Ä–µ–∫–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ</p>
                                <p>‚Ä¢ –ö–∞–∂–¥–æ–µ 1-–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω—É–ª—è–µ—Ç—Å—è</p>
                                <p>‚Ä¢ –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–ª—è—Ö</p>
                                <p>‚Ä¢ –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –≤ Telegram</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- –ö–Ω–æ–ø–∫–∞ "!" –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
        <button class="info-button" id="infoButton">!</button>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p class="made-with-love">–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –≤ –ú–∞–π</p>
                <a href="https://t.me/maytrue" target="_blank" class="telegram-link">t.me/maytrue</a>
            </div>
        </footer>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Å–∫—Ä—ã—Ç—ã–π) -->
    <div id="exportContainer" class="export-container">
        <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="export-logo" onerror="this.style.display='none'">
        <div class="export-title">–ú–æ–π –±–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏</div>
        <canvas id="exportChart" width="400" height="300"></canvas>
        <div class="export-watermark">—Ç–≥: maytrue</div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
    <div class="progress-overlay" id="progressOverlay">
        <div class="progress-info" id="progressInfo">–°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...</div>
        <div class="progress-bar-overlay">
            <div class="progress-fill-overlay" id="progressFillOverlay"></div>
        </div>
    </div>

    <div class="notification" id="notification">–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!</div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram
        function isTelegramWebApp() {
            return window.Telegram && window.Telegram.WebApp;
        }

        // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è Telegram Web App API –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω–µ Telegram
        if (!isTelegramWebApp()) {
            window.Telegram = {
                WebApp: {
                    expand: function() { console.log('Telegram Web App: expand()'); },
                    enableClosingConfirmation: function() { console.log('Telegram Web App: enableClosingConfirmation()'); },
                    ready: function() { console.log('Telegram Web App: ready()'); },
                    close: function() { console.log('Telegram Web App: close()'); }
                }
            };
        }

        class WellnessTracker {
            constructor() {
                this.categories = [
                    {
                        name: "–¢–µ–ª–æ",
                        description: "–§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å–ø–æ—Ä—Ç, –ø–∏—Ç–∞–Ω–∏–µ, –∑–¥–æ—Ä–æ–≤—å–µ",
                        icon: "üí™"
                    },
                    {
                        name: "–ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",
                        description: "–ú–µ–¥–∏—Ç–∞—Ü–∏—è, –æ—Ç–¥—ã—Ö, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–æ–º",
                        icon: "üß†"
                    },
                    {
                        name: "–°–º—ã—Å–ª—ã",
                        description: "–¶–µ–ª–∏, –º–∏—Å—Å–∏—è, —Ü–µ–Ω–Ω–æ—Å—Ç–∏, —Ä–µ—Ñ–ª–µ–∫—Å–∏—è",
                        icon: "üéØ"
                    },
                    {
                        name: "–û—Ç–Ω–æ—à–µ–Ω–∏—è",
                        description: "–û–±—â–µ–Ω–∏–µ —Å –±–ª–∏–∑–∫–∏–º–∏, –¥—Ä—É–∑—å—è–º–∏, –∫–æ–ª–ª–µ–≥–∞–º–∏",
                        icon: "‚ù§Ô∏è"
                    },
                    {
                        name: "–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç –∏ —Ö–æ–±–±–∏",
                        description: "–û–±—É—á–µ–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, —É–≤–ª–µ—á–µ–Ω–∏—è",
                        icon: "üå±"
                    },
                    {
                        name: "–î–µ–ª–æ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
                        description: "–†–∞–±–æ—Ç–∞, –ø—Ä–æ–µ–∫—Ç—ã, —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
                        icon: "üíº"
                    },
                    {
                        name: "–ü—Ä–∏—Ä–æ–¥–∞",
                        description: "–ü—Ä–æ–≥—É–ª–∫–∏ –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ, –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø—Ä–∏—Ä–æ–¥–æ–π",
                        icon: "üå≥"
                    },
                    {
                        name: "–ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ",
                        description: "–°–æ–Ω, –≥–∏–≥–∏–µ–Ω–∞, —Ä–µ–∂–∏–º –¥–Ω—è, —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ",
                        icon: "‚ú®"
                    }
                ];

                this.currentDate = new Date();
                this.userData = this.loadUserData();
                this.charts = {};
                this.telegramWebApp = null;
                
                this.init();
            }

            init() {
                this.initTelegramWebApp();
                this.setupEventListeners();
                this.renderCategories();
                this.loadDayData();
                this.updateMonthDisplay();
                this.checkMonthlyReset();
                this.restrictToCurrentMonth();
            }

            initTelegramWebApp() {
                if (isTelegramWebApp()) {
                    this.telegramWebApp = window.Telegram.WebApp;
                    this.telegramWebApp.expand();
                    this.telegramWebApp.enableClosingConfirmation();
                    this.telegramWebApp.ready();
                } else {
                    console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω–µ Telegram');
                }
            }

            getSeasonIcon(month) {
                if (month >= 2 && month <= 4) return 'üå±'; // –í–µ—Å–Ω–∞
                if (month >= 5 && month <= 7) return '‚òÄÔ∏è'; // –õ–µ—Ç–æ
                if (month >= 8 && month <= 10) return 'üçÇ'; // –û—Å–µ–Ω—å
                return '‚ùÑÔ∏è'; // –ó–∏–º–∞
            }

            loadUserData() {
                const data = localStorage.getItem('wellnessTrackerData');
                if (data) {
                    return JSON.parse(data);
                } else {
                    return {
                        activities: {},
                        settings: {},
                        lastResetMonth: new Date().getMonth()
                    };
                }
            }

            saveUserData() {
                localStorage.setItem('wellnessTrackerData', JSON.stringify(this.userData));
            }

            restrictToCurrentMonth() {
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                
                Object.keys(this.userData.activities).forEach(date => {
                    const dateObj = new Date(date);
                    if (dateObj.getMonth() !== currentMonth || dateObj.getFullYear() !== currentYear) {
                        delete this.userData.activities[date];
                    }
                });
                
                this.saveUserData();
            }

            checkMonthlyReset() {
                const today = new Date();
                const currentMonth = today.getMonth();
                const currentDay = today.getDate();
                
                if (currentDay === 1 && this.userData.lastResetMonth !== currentMonth) {
                    this.userData.lastResetMonth = currentMonth;
                    this.userData.activities = {};
                    this.saveUserData();
                    this.showNotification('–ù–∞—á–∞–ª—Å—è –Ω–æ–≤—ã–π –º–µ—Å—è—Ü! –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω—É–ª–µ–Ω–∞.');
                    this.loadDayData();
                }
            }

            setupEventListeners() {
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const tabName = e.target.getAttribute('data-tab');
                        this.switchTab(tabName);
                    });
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                document.getElementById('infoButton').addEventListener('click', () => {
                    this.switchTab('info');
                });

                document.getElementById('prevDay').addEventListener('click', () => {
                    const prevDate = new Date(this.currentDate);
                    prevDate.setDate(prevDate.getDate() - 1);
                    
                    const firstDayOfMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);
                    if (prevDate >= firstDayOfMonth) {
                        this.changeDate(-1);
                    }
                });

                document.getElementById('nextDay').addEventListener('click', () => {
                    const nextDate = new Date(this.currentDate);
                    nextDate.setDate(nextDate.getDate() + 1);
                    
                    const today = new Date();
                    if (nextDate <= today) {
                        this.changeDate(1);
                    }
                });

                document.getElementById('shareStats').addEventListener('click', () => {
                    this.shareStatistics();
                });

                // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.category-item')) {
                        setTimeout(() => this.autoSave(), 100);
                    }
                });
            }

            switchTab(tabName) {
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.classList.remove('active');
                });
                
                // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É "info", –Ω–µ –≤—ã–¥–µ–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ —Ç–∞–±–∞—Ö
                if (tabName !== 'info') {
                    document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                }
                
                document.getElementById(tabName).classList.add('active');

                if (tabName === 'analytics') {
                    this.loadAnalytics();
                } else if (tabName === 'recommendations') {
                    this.generateRecommendations();
                }
            }

            changeDate(days) {
                this.currentDate.setDate(this.currentDate.getDate() + days);
                this.updateDateDisplay();
                this.loadDayData();
            }

            updateDateDisplay() {
                const now = new Date();
                const dateElem = document.getElementById('currentDate');
                
                if (this.currentDate.toDateString() === now.toDateString()) {
                    dateElem.textContent = '–°–µ–≥–æ–¥–Ω—è';
                } else if (this.currentDate.toDateString() === new Date(now.setDate(now.getDate() - 1)).toDateString()) {
                    dateElem.textContent = '–í—á–µ—Ä–∞';
                } else {
                    dateElem.textContent = this.currentDate.toLocaleDateString('ru-RU');
                }

                const prevDayButton = document.getElementById('prevDay');
                const nextDayButton = document.getElementById('nextDay');
                
                const firstDayOfMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);
                const today = new Date();
                
                prevDayButton.disabled = this.currentDate <= firstDayOfMonth;
                nextDayButton.disabled = this.currentDate >= today;
            }

            updateMonthDisplay() {
                const monthNames = [
                    '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                    '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
                ];
                const currentMonth = this.currentDate.getMonth();
                document.getElementById('monthName').textContent = monthNames[currentMonth];
                document.getElementById('seasonIcon').textContent = this.getSeasonIcon(currentMonth);
            }

            renderCategories() {
                const container = document.getElementById('categoriesList');
                container.innerHTML = '';

                this.categories.forEach((category, index) => {
                    const categoryElem = document.createElement('div');
                    categoryElem.className = 'category-item';
                    categoryElem.dataset.categoryIndex = index;
                    categoryElem.innerHTML = `
                        <div class="category-header">
                            <span class="category-name">${category.icon} ${category.name}</span>
                            <div class="category-checkbox"></div>
                        </div>
                        <div class="category-description">${category.description}</div>
                    `;

                    categoryElem.addEventListener('click', () => {
                        categoryElem.classList.toggle('completed');
                    });

                    container.appendChild(categoryElem);
                });
            }

            autoSave() {
                const completed = document.querySelectorAll('.category-item.completed').length;
                if (completed > 0) {
                    this.saveDayData();
                }
            }

            loadDayData() {
                const dateString = this.formatDate(this.currentDate);
                const dayData = this.userData.activities[dateString];
                
                if (dayData) {
                    this.applyDayData(dayData);
                } else {
                    document.querySelectorAll('.category-item').forEach(item => {
                        item.classList.remove('completed');
                    });
                }
            }

            applyDayData(dayData) {
                document.querySelectorAll('.category-item').forEach(item => {
                    item.classList.remove('completed');
                });

                dayData.forEach(activity => {
                    const categoryElem = document.querySelector(`[data-category-index="${activity.categoryIndex}"]`);
                    if (categoryElem && activity.completed) {
                        categoryElem.classList.add('completed');
                    }
                });
            }

            saveDayData() {
                const dateString = this.formatDate(this.currentDate);
                const categories = Array.from(document.querySelectorAll('.category-item')).map((item, index) => {
                    const completed = item.classList.contains('completed');
                    
                    return {
                        categoryIndex: index,
                        name: this.categories[index].name,
                        completed: completed,
                        notes: ''
                    };
                });

                this.userData.activities[dateString] = categories;
                this.saveUserData();
                this.showNotification('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            }

            loadAnalytics() {
                const month = this.formatDate(this.currentDate).slice(0, 7);
                const stats = this.calculateStats(month);
                
                this.renderMonthlyProgress(stats);
                this.renderCharts(month);
                this.renderCategoryPercentages(stats);
            }

            calculateStats(month) {
                const stats = {};
                const daysPassed = this.getDaysPassedInMonth();
                
                this.categories.forEach((category, index) => {
                    stats[index] = {
                        category: category.name,
                        total_days: 0,
                        completed_days: 0,
                        completion_rate: 0
                    };
                });

                Object.keys(this.userData.activities).forEach(date => {
                    if (date.startsWith(month)) {
                        const dayData = this.userData.activities[date];
                        
                        dayData.forEach(activity => {
                            if (stats[activity.categoryIndex]) {
                                stats[activity.categoryIndex].total_days++;
                                if (activity.completed) {
                                    stats[activity.categoryIndex].completed_days++;
                                }
                            }
                        });
                    }
                });

                Object.keys(stats).forEach(categoryIndex => {
                    const stat = stats[categoryIndex];
                    if (daysPassed > 0) {
                        stat.completion_rate = Math.round((stat.completed_days / daysPassed) * 100);
                    }
                });

                return Object.values(stats);
            }

            renderMonthlyProgress(stats) {
                const totalTrackedDays = Object.keys(this.userData.activities).length;
                const daysInMonth = this.getDaysInMonth();
                const monthlyProgress = daysInMonth > 0 ? Math.round((totalTrackedDays / daysInMonth) * 100) : 0;

                document.getElementById('monthlyProgressFill').style.width = `${monthlyProgress}%`;
                document.getElementById('monthlyProgressText').textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –º–µ—Å—è—Ü: ${monthlyProgress}% (${totalTrackedDays}/${daysInMonth} –¥–Ω–µ–π)`;
            }

            renderCategoryPercentages(stats) {
                const container = document.getElementById('categoryPercentages');
                container.innerHTML = '';

                stats.forEach(stat => {
                    const percentageElem = document.createElement('div');
                    percentageElem.className = 'category-percentage';
                    percentageElem.innerHTML = `
                        <span class="category-percentage-name">${stat.category}</span>
                        <span class="category-percentage-value">${stat.completion_rate}%</span>
                    `;
                    container.appendChild(percentageElem);
                });
            }

            getDaysInMonth() {
                const date = new Date(this.currentDate);
                return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
            }

            getDaysPassedInMonth() {
                const today = new Date();
                return today.getDate();
            }

            renderCharts(month) {
                this.renderProgressChart(month);
                this.renderDistributionChart(month);
            }

            renderProgressChart(month) {
                const ctx = document.getElementById('progressChart').getContext('2d');
                
                if (this.charts.progress) {
                    this.charts.progress.destroy();
                }

                const stats = this.calculateStats(month);

                const categoryColors = [
                    '#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0',
                    '#118AB2', '#EF476F', '#073B4C', '#7209B7'
                ];

                this.charts.progress = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: stats.map(stat => stat.category),
                        datasets: [{
                            label: '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (%)',
                            data: stats.map(stat => stat.completion_rate),
                            backgroundColor: categoryColors,
                            borderColor: '#000000',
                            borderWidth: 0,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45
                                }
                            }
                        }
                    }
                });
            }

            renderDistributionChart(month) {
                const ctx = document.getElementById('distributionChart').getContext('2d');
                
                if (this.charts.distribution) {
                    this.charts.distribution.destroy();
                }

                const stats = this.calculateStats(month);
                const totalCompleted = stats.reduce((sum, stat) => sum + stat.completed_days, 0);

                const categoryColors = [
                    '#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0',
                    '#118AB2', '#EF476F', '#073B4C', '#7209B7'
                ];

                this.charts.distribution = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: stats.map(stat => stat.category),
                        datasets: [{
                            data: stats.map(stat => stat.completed_days),
                            backgroundColor: categoryColors,
                            borderColor: '#fffdfa',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    font: {
                                        size: 10
                                    }
                                }
                            }
                        }
                    }
                });
            }

            async createExportChart() {
                const month = this.formatDate(this.currentDate).slice(0, 7);
                const stats = this.calculateStats(month);

                const categoryColors = [
                    '#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0',
                    '#118AB2', '#EF476F', '#073B4C', '#7209B7'
                ];

                const ctx = document.getElementById('exportChart').getContext('2d');
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫
                const existingChart = Chart.getChart(ctx);
                if (existingChart) {
                    existingChart.destroy();
                }

                return new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: stats.map(stat => stat.category),
                        datasets: [{
                            data: stats.map(stat => stat.completed_days),
                            backgroundColor: categoryColors,
                            borderColor: '#fffdfa',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: false,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    font: {
                                        size: 11
                                    }
                                }
                            }
                        }
                    }
                });
            }

            async shareStatistics() {
                try {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
                    this.showProgress('–°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...', 0);
                    
                    // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
                    await this.createExportChart();
                    this.updateProgress('–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ...', 30);
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    this.updateProgress('–°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...', 60);
                    
                    const canvas = await html2canvas(document.getElementById('exportContainer'), {
                        backgroundColor: '#ffffff',
                        scale: 2,
                        logging: false,
                        useCORS: true
                    });

                    this.updateProgress('–ó–∞–≤–µ—Ä—à–∞–µ–º...', 90);
                    
                    const dataUrl = canvas.toDataURL('image/png');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ Web Share API
                    if (navigator.share) {
                        // –°–æ–∑–¥–∞–µ–º Blob –∏–∑ Data URL
                        const response = await fetch(dataUrl);
                        const blob = await response.blob();
                        const file = new File([blob], `–±–∞–ª–∞–Ω—Å-–∂–∏–∑–Ω–∏-${this.formatDate(this.currentDate)}.png`, {
                            type: 'image/png'
                        });
                        
                        if (navigator.canShare && navigator.canShare({ files: [file] })) {
                            await navigator.share({
                                files: [file],
                                title: '–ú–æ–π –±–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏',
                                text: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –º–æ–π –±–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏! üìä\n\n–ü–æ–¥—Ä–æ–±–Ω–µ–µ: t.me/maytrue'
                            });
                            this.hideProgress();
                            this.showNotification('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
                        } else {
                            // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–±–º–µ–Ω —Ñ–∞–π–ª–∞–º–∏
                            this.hideProgress();
                            this.showShareFallback(dataUrl);
                        }
                    } else {
                        // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Web Share API
                        this.hideProgress();
                        this.showShareFallback(dataUrl);
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', error);
                    this.hideProgress();
                    if (error.name !== 'AbortError') {
                        this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ');
                    }
                }
            }

            showProgress(text, percent) {
                const overlay = document.getElementById('progressOverlay');
                const progressInfo = document.getElementById('progressInfo');
                const progressFill = document.getElementById('progressFillOverlay');
                
                progressInfo.textContent = text;
                progressFill.style.width = percent + '%';
                overlay.classList.add('active');
            }

            updateProgress(text, percent) {
                const progressInfo = document.getElementById('progressInfo');
                const progressFill = document.getElementById('progressFillOverlay');
                
                progressInfo.textContent = text;
                progressFill.style.width = percent + '%';
            }

            hideProgress() {
                const overlay = document.getElementById('progressOverlay');
                overlay.classList.remove('active');
            }

            showShareFallback(dataUrl) {
                const newWindow = window.open();
                newWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π</title>
                        <style>
                            body { 
                                font-family: Arial, sans-serif; 
                                padding: 20px; 
                                text-align: center; 
                                background: #f5f5f5;
                            }
                            .container { 
                                max-width: 500px; 
                                margin: 0 auto; 
                                background: white;
                                padding: 20px;
                                border-radius: 10px;
                                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                            }
                            img { 
                                max-width: 100%; 
                                height: auto; 
                                border: 1px solid #ddd;
                                border-radius: 5px;
                            }
                            .instructions {
                                margin: 20px 0;
                                color: #666;
                                font-size: 14px;
                            }
                            .button {
                                display: inline-block;
                                padding: 10px 20px;
                                background: #553922;
                                color: white;
                                text-decoration: none;
                                border-radius: 5px;
                                margin: 10px;
                                cursor: pointer;
                            }
                            .telegram-link {
                                margin: 15px 0;
                                color: #0088cc;
                                font-size: 16px;
                                text-decoration: none;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="container">
                            <h2>–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–æ—Ç–æ–≤–∞!</h2>
                            <div class="instructions">
                                <p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –≤ Telegram:</p>
                                <p>1. –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
                                <p>2. –í—ã–±–µ—Ä–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"</p>
                                <p>3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —á–∞—Ç Telegram</p>
                            </div>
                            <img src="${dataUrl}" alt="–ë–∞–ª–∞–Ω—Å –∂–∏–∑–Ω–∏">
                            <div>
                                <a href="https://t.me/maytrue" target="_blank" class="telegram-link">üì¢ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª: t.me/maytrue</a>
                            </div>
                            <div>
                                <a href="${dataUrl}" download="–±–∞–ª–∞–Ω—Å-–∂–∏–∑–Ω–∏.png" class="button">–°–∫–∞—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</a>
                            </div>
                        </div>
                    </body>
                    </html>
                `);
            }

            generateRecommendations() {
                const container = document.getElementById('recommendationsList');
                const month = this.formatDate(this.currentDate).slice(0, 7);
                const stats = this.calculateStats(month);
                
                const lowPerformance = stats
                    .filter(stat => stat.completion_rate < 50)
                    .sort((a, b) => a.completion_rate - b.completion_rate)
                    .slice(0, 3);
                
                const recommendations = [];
                
                lowPerformance.forEach(stat => {
                    let recommendation = {};
                    
                    switch(stat.category) {
                        case "–¢–µ–ª–æ":
                            recommendation = {
                                title: "–£–ª—É—á—à–∏—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é.`
                            };
                            break;
                        case "–ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ":
                            recommendation = {
                                title: "–ü–æ–∑–∞–±–æ—Ç—å—Ç–µ—Å—å –æ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –∑–¥–æ—Ä–æ–≤—å–µ",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è 5-–º–∏–Ω—É—Ç–Ω–∞—è –º–µ–¥–∏—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å –≤–∞—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.`
                            };
                            break;
                        case "–°–º—ã—Å–ª—ã":
                            recommendation = {
                                title: "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–≤–æ–∏ —Ü–µ–ª–∏ –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –í—ã–¥–µ–ª–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ —Å–≤–æ–∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö.`
                            };
                            break;
                        case "–û—Ç–Ω–æ—à–µ–Ω–∏—è":
                            recommendation = {
                                title: "–£–¥–µ–ª–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–ª–∏–∑–∫–∏–º–∏ —É–∫—Ä–µ–ø–ª—è–µ—Ç —Å–≤—è–∑–∏.`
                            };
                            break;
                        case "–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç –∏ —Ö–æ–±–±–∏":
                            recommendation = {
                                title: "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ—Å—å –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è —Ö–æ–±–±–∏",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –í—ã–¥–µ–ª–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –∏–ª–∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ.`
                            };
                            break;
                        case "–î–µ–ª–æ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã":
                            recommendation = {
                                title: "–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –¥–µ–ª–∞ –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å —Ü–µ–ª–µ–π.`
                            };
                            break;
                        case "–ü—Ä–∏—Ä–æ–¥–∞":
                            recommendation = {
                                title: "–ü—Ä–æ–≤–æ–¥–∏—Ç–µ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –ü—Ä–æ–≥—É–ª–∫–∏ –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ —É–ª—É—á—à–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.`
                            };
                            break;
                        case "–ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ":
                            recommendation = {
                                title: "–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ –∑–∞–±–æ—Ç–µ –æ —Å–µ–±–µ",
                                description: `–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${stat.completion_rate}%. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–¥—ã—Ö - –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.`
                            };
                            break;
                        default:
                            return;
                    }
                    
                    recommendations.push(recommendation);
                });

                const inspiringQuotes = [
                    "–ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –±–æ–ª—å—à–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º! üåü",
                    "–ë–∞–ª–∞–Ω—Å - —ç—Ç–æ –Ω–µ –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞, –∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≥–∞—Ä–º–æ–Ω–∏–∏.",
                    "–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —É—Å–∏–ª–∏—è - —ç—Ç–æ –∑–∞–≤—Ç—Ä–∞—à–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!",
                    "–ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ - —ç—Ç–æ –Ω–µ —ç–≥–æ–∏–∑–º, –∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–ª—è —Ä–æ—Å—Ç–∞.",
                    "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å - –Ω–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –∏ —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—è.",
                    "–ì–∞—Ä–º–æ–Ω–∏—è –≤ –∂–∏–∑–Ω–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±–∞–ª–∞–Ω—Å–∞ –≤ –º–µ–ª–æ—á–∞—Ö. –í—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏!",
                    "–í–∞—à–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ - –ª—É—á—à–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ —Å—á–∞—Å—Ç–ª–∏–≤–æ–µ –±—É–¥—É—â–µ–µ.",
                    "–ù–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –ø—É—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ - —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–µ–º–ø —Ä–æ—Å—Ç–∞."
                ];

                if (recommendations.length === 0) {
                    recommendations.push(
                        {
                            title: "–û—Ç–ª–∏—á–Ω—ã–π –±–∞–ª–∞–Ω—Å! üéâ",
                            description: "–í—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –º–µ–∂–¥—É –≤—Å–µ–º–∏ —Å—Ñ–µ—Ä–∞–º–∏ –∂–∏–∑–Ω–∏. –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!"
                        },
                        {
                            title: "–°–æ–≤–µ—Ç –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞",
                            description: "–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –æ—Ç–º–µ—á–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å—Ñ–µ—Ä—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è."
                        }
                    );
                }

                const randomQuote = inspiringQuotes[Math.floor(Math.random() * inspiringQuotes.length)];
                
                let html = recommendations.map(rec => `
                    <div class="recommendation-item fade-in">
                        <h4>${rec.title}</h4>
                        <p>${rec.description}</p>
                    </div>
                `).join('');

                html += `<div class="inspiration-quote">${randomQuote}</div>`;

                container.innerHTML = html;
            }

            formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            showNotification(message) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            new WellnessTracker();
        });
    </script>
</body>
</html>
